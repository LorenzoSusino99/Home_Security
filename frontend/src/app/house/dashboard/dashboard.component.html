<div class="flex flex-col">
    <div class="flex justify-center items-center gap-16 mt-10">
        <!-- Indicatore Effrazione -->
        <div class="flex flex-col items-center">
            <mat-slide-toggle *ngIf="userRole === 'admin'" [(ngModel)]="burglaryEnabled" (change)="onToggleBurglary()">
                {{ burglaryEnabled ? 'Acceso' : 'Spento' }}
            </mat-slide-toggle>

            <div [ngClass]="{
        'border-green-500': burglaryStatus === 'green',
        'border-red-500': burglaryStatus === 'red',
        'border-gray-400': burglaryStatus === 'gray'
      }" class="w-64 h-64 m-10 mx-20 border-[6px] rounded-full flex items-center justify-center text-center text-lg font-medium">
                Antieffrazione
            </div>
        </div>

        <!-- Indicatore Gas -->
        <div class="flex flex-col items-center">
            <mat-slide-toggle *ngIf="userRole === 'admin'" [(ngModel)]="gasEnabled" (change)="onToggleGas()">
                {{ gasEnabled ? 'Acceso' : 'Spento' }}
            </mat-slide-toggle>

            <div [ngClass]="{
        'border-green-500': gasStatus === 'green',
        'border-red-500': gasStatus === 'red'
      }" class="w-64 h-64 m-10 mx-20 border-[6px] rounded-full flex items-center justify-center text-center text-lg font-medium">
                Antincendio
            </div>
        </div>
    </div>
    <div class="mt-16 w-full w-full mx-auto">
        <mat-card class="p-8 align-center">
            <div class="flex-1 w-full">
                <span class="text-2xl w-fit"><b>Allarmi Attivi</b></span>
            </div>
            <button class="w-fit mt-5" mat-raised-button color="warn" (click)="resolveAllAlarms()"
                [disabled]="pendingAlarms.length === 0">
                Risolvi tutti
            </button>
        </mat-card>

        <table mat-table [dataSource]="pendingAlarms" class="w-full" *ngIf="pendingAlarms.length > 0">

            <!-- Device ID -->
            <ng-container matColumnDef="deviceId">
                <th mat-header-cell *matHeaderCellDef>Device</th>
                <td mat-cell *matCellDef="let el">{{ el.deviceId }}</td>
            </ng-container>

            <!-- Tipo -->
            <ng-container matColumnDef="type">
                <th mat-header-cell *matHeaderCellDef>Tipo</th>
                <td mat-cell *matCellDef="let el">{{ el.type }}</td>
            </ng-container>

            <!-- Data -->
            <ng-container matColumnDef="timestamp">
                <th mat-header-cell *matHeaderCellDef>Data</th>
                <td mat-cell *matCellDef="let el">{{ el.timestamp | date:'dd/MM/yyyy HH:mm'}}</td>
            </ng-container>

            <!-- Azione -->
            <ng-container matColumnDef="action">
                <th mat-header-cell *matHeaderCellDef>Azioni</th>
                <td mat-cell *matCellDef="let el">
                    <button mat-button color="primary" (click)="resolveAlarm(el)">Risolvi</button>
                </td>
            </ng-container>

            <!-- Header e righe -->
            <tr mat-header-row *matHeaderRowDef="['deviceId', 'type', 'timestamp', 'action']"></tr>
            <tr mat-row *matRowDef="let row; columns: ['deviceId', 'type', 'timestamp', 'action'];"></tr>
        </table>

        <p *ngIf="pendingAlarms.length === 0" class="text-center text-gray-500 mt-4">
            Nessuna allarme attivo.
        </p>
    </div>
</div>